# å·¥ä½œæµå¼•æ“ (Workflow Engine)

[![Go Version](https://img.shields.io/badge/Go-1.21+-blue.svg)](https://golang.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)
[![Build Status](https://img.shields.io/badge/Build-Passing-brightgreen.svg)]()
[![Coverage](https://img.shields.io/badge/Coverage-96%25-brightgreen.svg)]()
[![Docker](https://img.shields.io/badge/Docker-Ready-blue.svg)]()
[![Kubernetes](https://img.shields.io/badge/Kubernetes-Ready-blue.svg)]()

ä¸€ä¸ªåŸºäº Go è¯­è¨€å¼€å‘çš„é«˜æ€§èƒ½ã€å¯æ‰©å±•çš„å·¥ä½œæµç®¡ç†ç³»ç»Ÿã€‚é‡‡ç”¨å¾®æœåŠ¡æ¶æ„ï¼Œæ”¯æŒå¤æ‚çš„ä¸šåŠ¡æµç¨‹ç¼–æ’å’Œè‡ªåŠ¨åŒ–ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸš€ é«˜æ€§èƒ½
- **å¾®æœåŠ¡æ¶æ„**: åŸºäº Kratos v2 æ¡†æ¶çš„é«˜æ€§èƒ½å¾®æœåŠ¡
- **å¹¶å‘å¤„ç†**: æ”¯æŒé«˜å¹¶å‘å·¥ä½œæµæ‰§è¡Œ
- **ç¼“å­˜ä¼˜åŒ–**: Redis å¤šçº§ç¼“å­˜ç­–ç•¥
- **æ•°æ®åº“ä¼˜åŒ–**: PostgreSQL è¿æ¥æ± å’ŒæŸ¥è¯¢ä¼˜åŒ–

### ğŸ›¡ï¸ å¯é æ€§
- **åˆ†å¸ƒå¼**: åŸºäº Temporal çš„åˆ†å¸ƒå¼å·¥ä½œæµå¼•æ“
- **é«˜å¯ç”¨**: æ”¯æŒé›†ç¾¤éƒ¨ç½²å’Œæ•…éšœè½¬ç§»
- **æ•°æ®ä¸€è‡´æ€§**: å¼ºä¸€è‡´æ€§ä¿è¯å’Œäº‹åŠ¡æ”¯æŒ
- **å¤‡ä»½æ¢å¤**: å®Œæ•´çš„å¤‡ä»½å’Œç¾éš¾æ¢å¤æ–¹æ¡ˆ

### ğŸ” å®‰å…¨æ€§
- **JWT è®¤è¯**: ä¼ä¸šçº§ JWT è®¤è¯ç³»ç»Ÿ
- **RBAC æƒé™**: åŸºäºè§’è‰²çš„è®¿é—®æ§åˆ¶
- **API ä¿æŠ¤**: å…¨ API JWT è®¤è¯è¦†ç›–
- **æ•°æ®åŠ å¯†**: æ”¯æŒæ•°æ®ä¼ è¾“å’Œå­˜å‚¨åŠ å¯†

### ğŸ“Š ç›‘æ§è¿ç»´
- **Prometheus ç›‘æ§**: å®Œæ•´çš„ç³»ç»Ÿç›‘æ§æŒ‡æ ‡
- **Grafana ä»ªè¡¨æ¿**: å®æ—¶ç›‘æ§å¯è§†åŒ–
- **æ—¥å¿—ç®¡ç†**: ç»“æ„åŒ–æ—¥å¿—å’Œé›†ä¸­å¼æ—¥å¿—æ”¶é›†
- **å¥åº·æ£€æŸ¥**: å¤šçº§å¥åº·æ£€æŸ¥æœºåˆ¶

### ğŸ”§ å¼€å‘å‹å¥½
- **RESTful API**: æ ‡å‡†åŒ– API è®¾è®¡
- **å¤šè¯­è¨€ SDK**: Goã€JavaScriptã€Python SDK æ”¯æŒ
- **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†çš„ç”¨æˆ·æ‰‹å†Œå’Œ API æ–‡æ¡£
- **å®¹å™¨åŒ–**: Docker å’Œ Kubernetes éƒ¨ç½²æ”¯æŒ

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     å·¥ä½œæµå¼•æ“æ¶æ„å›¾                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Frontend        â”‚  API Gateway     â”‚  Backend Services    â”‚
â”‚                  â”‚                  â”‚                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚   Web UI    â”‚ â”‚ â”‚   Gateway   â”‚  â”‚ â”‚  Process Mgmt   â”‚  â”‚
â”‚  â”‚             â”‚ â”‚ â”‚             â”‚  â”‚ â”‚                 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚Dashboardâ”‚ â”‚ â”‚ â”‚ â”‚  Auth   â”‚ â”‚  â”‚ â”‚ â”‚ Definitions â”‚ â”‚  â”‚
â”‚  â”‚ â”‚         â”‚ â”‚ â”‚ â”‚ â”‚         â”‚ â”‚  â”‚ â”‚ â”‚             â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚             â”‚ â”‚ â”‚             â”‚  â”‚ â”‚                 â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚Designer â”‚ â”‚ â”‚ â”‚ â”‚ Router  â”‚ â”‚  â”‚ â”‚ â”‚  Instances  â”‚ â”‚  â”‚
â”‚  â”‚ â”‚         â”‚ â”‚ â”‚ â”‚ â”‚         â”‚ â”‚  â”‚ â”‚ â”‚             â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                  â”‚                  â”‚                      â”‚
â”‚                  â”‚                  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                  â”‚                  â”‚ â”‚   Task Mgmt     â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚                 â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”‚   Executor  â”‚ â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”‚             â”‚ â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚                 â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”‚  Scheduler  â”‚ â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â”‚             â”‚ â”‚  â”‚
â”‚                  â”‚                  â”‚ â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚                  â”‚                  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Storage Layer                         â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ PostgreSQL   â”‚  â”‚    Redis     â”‚  â”‚     Temporal     â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚Workflow  â”‚ â”‚  â”‚ â”‚  Cache   â”‚ â”‚  â”‚ â”‚   Workflow   â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  Data    â”‚ â”‚  â”‚ â”‚          â”‚ â”‚  â”‚ â”‚    Engine    â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â”‚              â”‚  â”‚              â”‚  â”‚                  â”‚  â”‚
â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚  â”‚
â”‚  â”‚ â”‚History   â”‚ â”‚  â”‚ â”‚Sessions  â”‚ â”‚  â”‚ â”‚   History    â”‚ â”‚  â”‚
â”‚  â”‚ â”‚  Data    â”‚ â”‚  â”‚ â”‚          â”‚ â”‚  â”‚ â”‚     Data     â”‚ â”‚  â”‚
â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    Monitoring & Ops                        â”‚
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ Prometheus   â”‚  â”‚   Grafana    â”‚  â”‚      Jaeger      â”‚  â”‚
â”‚  â”‚   Metrics    â”‚  â”‚  Dashboard   â”‚  â”‚     Tracing      â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- **Go**: 1.21 æˆ–æ›´é«˜ç‰ˆæœ¬
- **PostgreSQL**: 13+ (ç”¨äºæ•°æ®å­˜å‚¨)
- **Redis**: 6+ (ç”¨äºç¼“å­˜)
- **Docker**: 20.10+ (å¯é€‰ï¼Œç”¨äºå®¹å™¨åŒ–éƒ¨ç½²)
- **Kubernetes**: 1.20+ (å¯é€‰ï¼Œç”¨äº K8s éƒ¨ç½²)

### ä½¿ç”¨ Docker Compose å¿«é€Ÿå¯åŠ¨ (æ¨è)

```bash
# 1. å…‹éš†é¡¹ç›®
git clone https://github.com/workflow-engine/workflow-engine.git
cd workflow-engine

# 2. å¯åŠ¨å®Œæ•´ç¯å¢ƒ
docker-compose up -d

# 3. æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# 4. æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f workflow-engine
```

### æœ¬åœ°å¼€å‘ç¯å¢ƒ

```bash
# 1. å®‰è£…ä¾èµ–
go mod download

# 2. å¯åŠ¨ä¾èµ–æœåŠ¡
docker-compose up -d postgres redis temporal

# 3. è¿è¡Œæ•°æ®åº“è¿ç§»
make migrate-up

# 4. å¯åŠ¨åº”ç”¨
make run

# æˆ–è€…ç›´æ¥è¿è¡Œ
go run cmd/server/main.go
```

### éªŒè¯éƒ¨ç½²

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/health

# API æµ‹è¯•
curl -H "Content-Type: application/json" \
     -d '{"username":"admin","password":"password123"}' \
     http://localhost:8080/api/v1/auth/login
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### åŸºæœ¬æ¦‚å¿µ

#### æµç¨‹å®šä¹‰ (Process Definition)
æµç¨‹å®šä¹‰æ˜¯å·¥ä½œæµçš„æ¨¡æ¿ï¼Œå®šä¹‰äº†ä¸šåŠ¡æµç¨‹çš„ç»“æ„å’Œæ­¥éª¤ã€‚

```json
{
  "name": "è®¢å•å¤„ç†æµç¨‹",
  "description": "ç”µå•†è®¢å•å¤„ç†çš„å®Œæ•´å·¥ä½œæµç¨‹",
  "version": "1.0.0",
  "variables": {
    "order_id": "string",
    "customer_id": "string",
    "total_amount": "number"
  },
  "steps": [
    {
      "id": "validate_order",
      "name": "éªŒè¯è®¢å•",
      "type": "service_task",
      "config": {
        "service_name": "OrderValidationService",
        "method": "validate",
        "timeout": "30s"
      },
      "next": ["payment_check"]
    }
  ]
}
```

#### æµç¨‹å®ä¾‹ (Process Instance)
æµç¨‹å®ä¾‹æ˜¯æµç¨‹å®šä¹‰çš„å…·ä½“æ‰§è¡Œï¼ŒåŒ…å«å®é™…çš„ä¸šåŠ¡æ•°æ®ã€‚

```bash
# å¯åŠ¨æµç¨‹å®ä¾‹
curl -X POST http://localhost:8080/api/v1/process-instances \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "process_definition_id": 123,
    "business_key": "ORDER-001",
    "variables": {
      "order_id": "ORDER-001",
      "customer_id": "CUST-456",
      "total_amount": 999.99
    }
  }'
```

#### ä»»åŠ¡ç®¡ç† (Task Management)
ä»»åŠ¡æ˜¯æµç¨‹ä¸­éœ€è¦äººå·¥å¤„ç†çš„æ­¥éª¤ã€‚

```bash
# è·å–å¾…åŠä»»åŠ¡
curl -H "Authorization: Bearer <token>" \
  "http://localhost:8080/api/v1/tasks?assignee=current_user"

# å®Œæˆä»»åŠ¡
curl -X PUT http://localhost:8080/api/v1/tasks/789/complete \
  -H "Authorization: Bearer <token>" \
  -H "Content-Type: application/json" \
  -d '{
    "variables": {
      "approved": true,
      "comments": "å®¡æ‰¹é€šè¿‡"
    }
  }'
```

### é«˜çº§åŠŸèƒ½

#### æ¡ä»¶åˆ†æ”¯
```json
{
  "type": "exclusive_gateway",
  "config": {
    "conditions": [
      {
        "expression": "${amount > 1000}",
        "next": "manager_approval"
      },
      {
        "expression": "${amount <= 1000}",
        "next": "auto_approve"
      }
    ]
  }
}
```

#### å¹¶è¡Œå¤„ç†
```json
{
  "type": "parallel_gateway",
  "config": {
    "parallel_tasks": [
      "inventory_check",
      "credit_check",
      "fraud_check"
    ],
    "join_condition": "all_complete"
  }
}
```

#### å®šæ—¶å™¨äº‹ä»¶
```json
{
  "type": "timer_event",
  "config": {
    "duration": "2h",
    "action": "escalate_to_manager"
  }
}
```

## ğŸ”Œ API å‚è€ƒ

### è®¤è¯
æ‰€æœ‰ API è¯·æ±‚éƒ½éœ€è¦åœ¨ Header ä¸­åŒ…å«æœ‰æ•ˆçš„ JWT Tokenï¼š

```http
Authorization: Bearer <your-jwt-token>
```

### ä¸»è¦ç«¯ç‚¹

| æ–¹æ³• | ç«¯ç‚¹ | æè¿° |
|------|------|------|
| POST | `/api/v1/auth/login` | ç”¨æˆ·ç™»å½• |
| GET | `/api/v1/process-definitions` | è·å–æµç¨‹å®šä¹‰åˆ—è¡¨ |
| POST | `/api/v1/process-definitions` | åˆ›å»ºæµç¨‹å®šä¹‰ |
| POST | `/api/v1/process-instances` | å¯åŠ¨æµç¨‹å®ä¾‹ |
| GET | `/api/v1/process-instances` | è·å–æµç¨‹å®ä¾‹åˆ—è¡¨ |
| GET | `/api/v1/tasks` | è·å–ä»»åŠ¡åˆ—è¡¨ |
| PUT | `/api/v1/tasks/{id}/complete` | å®Œæˆä»»åŠ¡ |

å®Œæ•´çš„ API æ–‡æ¡£è¯·å‚è€ƒ: [API å‚è€ƒæ–‡æ¡£](docs/api-reference.md)

## ğŸ› ï¸ å¼€å‘æŒ‡å—

### é¡¹ç›®ç»“æ„

```
workflow-engine/
â”œâ”€â”€ cmd/                    # åº”ç”¨ç¨‹åºå…¥å£
â”‚   â””â”€â”€ server/            # æœåŠ¡å™¨å¯åŠ¨ç¨‹åº
â”œâ”€â”€ internal/              # å†…éƒ¨åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ auth/              # è®¤è¯æˆæƒæ¨¡å—
â”‚   â”œâ”€â”€ biz/               # ä¸šåŠ¡é€»è¾‘å±‚
â”‚   â”œâ”€â”€ data/              # æ•°æ®è®¿é—®å±‚
â”‚   â”œâ”€â”€ middleware/        # HTTP ä¸­é—´ä»¶
â”‚   â””â”€â”€ service/           # æœåŠ¡å±‚
â”œâ”€â”€ api/                   # API å®šä¹‰ (protobuf)
â”œâ”€â”€ configs/               # é…ç½®æ–‡ä»¶
â”œâ”€â”€ docs/                  # æ–‡æ¡£
â”œâ”€â”€ ent/                   # Ent ç”Ÿæˆçš„ä»£ç 
â”œâ”€â”€ scripts/               # è„šæœ¬æ–‡ä»¶
â”œâ”€â”€ tests/                 # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ integration/       # é›†æˆæµ‹è¯•
â”‚   â””â”€â”€ performance/       # æ€§èƒ½æµ‹è¯•
â”œâ”€â”€ deployments/           # éƒ¨ç½²é…ç½®
â”‚   â””â”€â”€ kubernetes/        # Kubernetes é…ç½®
â”œâ”€â”€ docker-compose.yaml    # Docker Compose é…ç½®
â””â”€â”€ Dockerfile            # Docker é•œåƒæ„å»ºæ–‡ä»¶
```

### æœ¬åœ°å¼€å‘

```bash
# è¿è¡Œæµ‹è¯•
make test

# ä»£ç æ ¼å¼åŒ–
make fmt

# é™æ€åˆ†æ
make lint

# ç”Ÿæˆä»£ç 
make generate

# æ„å»ºé¡¹ç›®
make build
```

### æ·»åŠ æ–°åŠŸèƒ½

1. **å®šä¹‰æ•°æ®æ¨¡å‹**: åœ¨ `ent/schema/` ä¸­å®šä¹‰æ•°æ®ç»“æ„
2. **å®ç°ä¸šåŠ¡é€»è¾‘**: åœ¨ `internal/biz/` ä¸­å®ç°ä¸šåŠ¡é€»è¾‘
3. **æ·»åŠ æœåŠ¡å±‚**: åœ¨ `internal/service/` ä¸­æ·»åŠ æœåŠ¡æ¥å£
4. **åˆ›å»º API**: å®šä¹‰ RESTful API ç«¯ç‚¹
5. **ç¼–å†™æµ‹è¯•**: æ·»åŠ å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### ä»£ç è§„èŒƒ

- éµå¾ª Go è¯­è¨€å®˜æ–¹ç¼–ç è§„èŒƒ
- ä½¿ç”¨ `gofmt` æ ¼å¼åŒ–ä»£ç 
- æ³¨é‡Šä½¿ç”¨ä¸­æ–‡ï¼Œä»£ç ä½¿ç”¨è‹±æ–‡
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- æ‰€æœ‰ public å‡½æ•°éƒ½è¦æœ‰æ³¨é‡Š

## ğŸš€ éƒ¨ç½²æŒ‡å—

### Docker éƒ¨ç½²

```bash
# æ„å»ºé•œåƒ
docker build -t workflow-engine:latest .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name workflow-engine \
  -p 8080:8080 \
  -e DATABASE_URL="postgres://user:password@host:5432/dbname" \
  -e REDIS_URL="redis://host:6379" \
  workflow-engine:latest
```

### Kubernetes éƒ¨ç½²

```bash
# åº”ç”¨é…ç½®
kubectl apply -f deployments/kubernetes/

# æ£€æŸ¥çŠ¶æ€
kubectl get pods -l app=workflow-engine

# æŸ¥çœ‹æ—¥å¿—
kubectl logs -f deployment/workflow-engine
```

### ç”Ÿäº§ç¯å¢ƒé…ç½®

#### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | é»˜è®¤å€¼ |
|--------|------|--------|
| `SERVER_PORT` | æœåŠ¡ç«¯å£ | `8080` |
| `DATABASE_URL` | æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸² | - |
| `REDIS_URL` | Redis è¿æ¥å­—ç¬¦ä¸² | - |
| `JWT_SECRET` | JWT å¯†é’¥ | - |
| `LOG_LEVEL` | æ—¥å¿—çº§åˆ« | `info` |

#### æ€§èƒ½è°ƒä¼˜

```yaml
# configs/production.yaml
server:
  port: 8080
  read_timeout: 30s
  write_timeout: 30s

database:
  max_open_conns: 100
  max_idle_conns: 25
  conn_max_lifetime: 10m

cache:
  default_expiration: 30m
  cleanup_interval: 5m
```

## ğŸ“Š ç›‘æ§

### Prometheus æŒ‡æ ‡

ç³»ç»Ÿæä¾›ä¸°å¯Œçš„ç›‘æ§æŒ‡æ ‡ï¼š

- `workflow_instances_total`: æµç¨‹å®ä¾‹æ€»æ•°
- `workflow_instances_active`: æ´»è·ƒæµç¨‹å®ä¾‹æ•°
- `task_completion_time`: ä»»åŠ¡å®Œæˆæ—¶é—´
- `api_request_duration`: API è¯·æ±‚å»¶è¿Ÿ
- `database_connections`: æ•°æ®åº“è¿æ¥æ•°

### Grafana ä»ªè¡¨æ¿

è®¿é—® http://localhost:3000 æŸ¥çœ‹é¢„é…ç½®çš„ç›‘æ§ä»ªè¡¨æ¿ï¼š

- **ç³»ç»Ÿæ¦‚è§ˆ**: æ•´ä½“ç³»ç»Ÿè¿è¡ŒçŠ¶æ€
- **æµç¨‹ç›‘æ§**: æµç¨‹æ‰§è¡Œæƒ…å†µå’Œæ€§èƒ½æŒ‡æ ‡
- **API ç›‘æ§**: HTTP è¯·æ±‚é‡å’Œå“åº”æ—¶é—´
- **åŸºç¡€è®¾æ–½**: æ•°æ®åº“ã€Redisã€èµ„æºä½¿ç”¨æƒ…å†µ

### å‘Šè­¦é…ç½®

```yaml
# alerts.yaml
groups:
  - name: workflow-engine
    rules:
      - alert: HighErrorRate
        expr: rate(http_requests_total{status=~"5.."}[5m]) > 0.1
        for: 5m
        annotations:
          summary: "å·¥ä½œæµå¼•æ“é”™è¯¯ç‡è¿‡é«˜"
```

## ğŸ”§ è¿ç»´

### å¤‡ä»½

```bash
# å®Œæ•´å¤‡ä»½
./scripts/backup.sh

# ä»…å¤‡ä»½æ•°æ®åº“
./scripts/backup.sh --db-only

# è‡ªåŠ¨å¤‡ä»½ (crontab)
0 2 * * * /opt/workflow-engine/scripts/backup.sh
```

### æ¢å¤

```bash
# å®Œæ•´æ¢å¤
./scripts/restore.sh /path/to/backup.tar.gz

# ä»…æ¢å¤æ•°æ®åº“
./scripts/restore.sh /path/to/backup.tar.gz --db-only
```

### æ—¥å¿—ç®¡ç†

```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
docker-compose logs -f workflow-engine

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
kubectl logs -l app=workflow-engine --tail=100 | grep ERROR
```

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. **Fork é¡¹ç›®**: åœ¨ GitHub ä¸Š fork æœ¬é¡¹ç›®
2. **åˆ›å»ºåˆ†æ”¯**: åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ `git checkout -b feature/new-feature`
3. **å¼€å‘åŠŸèƒ½**: å®ç°æ–°åŠŸèƒ½å¹¶æ·»åŠ æµ‹è¯•
4. **æäº¤ä»£ç **: æäº¤ä»£ç  `git commit -am 'Add new feature'`
5. **æ¨é€åˆ†æ”¯**: æ¨é€åˆ° GitHub `git push origin feature/new-feature`
6. **åˆ›å»º PR**: åœ¨ GitHub ä¸Šåˆ›å»º Pull Request

### ä»£ç å®¡æŸ¥

- æ‰€æœ‰ä»£ç å¿…é¡»é€šè¿‡ CI/CD æµ‹è¯•
- è‡³å°‘éœ€è¦ä¸€ä¸ªç»´æŠ¤è€…çš„ä»£ç å®¡æŸ¥
- ç¡®ä¿ä»£ç è¦†ç›–ç‡ä¸ä½äºå½“å‰æ°´å¹³
- æ›´æ–°ç›¸å…³æ–‡æ¡£

### é—®é¢˜åé¦ˆ

- é€šè¿‡ [GitHub Issues](https://github.com/workflow-engine/workflow-engine/issues) æŠ¥å‘Š bug
- æä¾›è¯¦ç»†çš„é—®é¢˜æè¿°å’Œå¤ç°æ­¥éª¤
- åŒ…å«ç³»ç»Ÿç¯å¢ƒä¿¡æ¯

## ğŸ“š æ›´å¤šèµ„æº

### æ–‡æ¡£

- [ç”¨æˆ·æ‰‹å†Œ](docs/user-manual.md) - è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—
- [API å‚è€ƒ](docs/api-reference.md) - å®Œæ•´çš„ API æ–‡æ¡£
- [å¼€å‘æŒ‡å—](docs/development-guide.md) - å¼€å‘è€…æŒ‡å—
- [éƒ¨ç½²æŒ‡å—](docs/deployment-guide.md) - ç”Ÿäº§éƒ¨ç½²æŒ‡å—

### ç¤¾åŒº

- [GitHub Discussions](https://github.com/workflow-engine/workflow-engine/discussions) - ç¤¾åŒºè®¨è®º
- [Stack Overflow](https://stackoverflow.com/questions/tagged/workflow-engine) - æŠ€æœ¯é—®ç­”
- [åšå®¢](https://blog.workflow-engine.dev) - æŠ€æœ¯åšå®¢

### æ”¯æŒ

- **ä¼ä¸šæ”¯æŒ**: enterprise@workflow-engine.dev
- **æŠ€æœ¯æ”¯æŒ**: support@workflow-engine.dev
- **å®‰å…¨é—®é¢˜**: security@workflow-engine.dev

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®ä½¿ç”¨ [MIT è®¸å¯è¯](LICENSE)ã€‚

## ğŸ™ è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®ï¼š

- [Kratos](https://github.com/go-kratos/kratos) - Go å¾®æœåŠ¡æ¡†æ¶
- [Ent](https://entgo.io/) - Go å®ä½“æ¡†æ¶
- [Temporal](https://temporal.io/) - å·¥ä½œæµå¼•æ“
- [Gin](https://github.com/gin-gonic/gin) - HTTP Web æ¡†æ¶
- [PostgreSQL](https://www.postgresql.org/) - æ•°æ®åº“
- [Redis](https://redis.io/) - ç¼“å­˜

---

**å·¥ä½œæµå¼•æ“** - è®©ä¸šåŠ¡æµç¨‹è‡ªåŠ¨åŒ–å˜å¾—ç®€å• âœ¨

[GitHub](https://github.com/workflow-engine/workflow-engine) |
[æ–‡æ¡£](https://docs.workflow-engine.dev) |
[æ¼”ç¤º](https://demo.workflow-engine.dev) |
[åšå®¢](https://blog.workflow-engine.dev) 